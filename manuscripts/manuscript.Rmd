---
title: "The importance of measurement uncertainty in ecological management"

author:
  - name: "Authors removed during peer review"

#  - name: "Milad Memarzadeh"
#    affiliation: a
#  - name: "Carl Boettiger"
#    affiliation: a, 1
#address:
#  - code: a
#    address: "Dept of Environmental Science, Policy, and Management, University of California Berkeley, Berkeley CA 94720-3114, USA"
  

abstract: |
  Ecological management and decision-making typically focus on uncertainty about the future, but surprisingly little is known about how to account for uncertainty of the present: that is, the realities of having only partial or imperfect measurements.  Our two primary paradigms for handling decisions under uncertainty -- the precautionary principle and optimal control -- have so far given entirely contradictory results.  This paradox is best illustrated in the example of fisheries management, where many ideas that guide thinking about ecological decision making were first developed.  We find that simplistic optimal control approaches have repeatedly concluded that a manager should increase catch quotas when faced with greater uncertainty about the fish biomass. Current best practices take a more precautionary approach, decreasing catch quotas by a fixed amount to account for uncertainty.  Using comparisons to both simulated and historical catch data, we find that neither approach is sufficient to avoid stock collapses under moderate observational uncertainty.  Using partially observed Markov decision process (POMDP) methods, we demonstrate how this paradox arises from flaws in the standard theory, which contributes to over-exploitation of fisheries and increased probability of economic and ecological collapse.  In contrast, we find POMDP-based management avoids such over-exploitation while also generating higher economic value.  These results have significant implications for how we handle uncertainty in both fisheries and ecological management more generally.


keywords:
  - Measurement uncertainty
  - POMDP
  - Decision theory
  - Fisheries
  - Conservation

lineno: true

bibliography: citations.bib
#journal: "The American Naturalist"
date: "`r Sys.Date()`"
csl: the-american-naturalist.csl
output: rticles::elsevier_article
layout: 3p # review # review = doublespace, 3p = singlespace, 5p = two-column
header-includes: |
        \journal{The American Naturalist}
        \usepackage{lineno}
        \linenumbers
        \modulolinenumbers[3]
        \usepackage{setspace}
        \doublespacing

---

```{r libraries, include=FALSE, message=FALSE, warning=FALSE}
knitr::opts_chunk$set(echo = FALSE, message=FALSE, warning=FALSE,  dev="cairo_pdf", cache = 1)
library(tidyverse)
library(gridExtra)
```

```{r optional_plot_fonts, message=FALSE}
library(ggplot2)
#library(Cairo)
library(extrafont)
library(hrbrthemes)
extrafont::loadfonts()
knitr::opts_chunk$set()
hrbrthemes::import_roboto_condensed() 
ggplot2::theme_set(hrbrthemes::theme_ipsum_rc())
#ggplot2::theme_set(hrbrthemes::theme_ipsum())
palette <- c("#D9661F", "#3B7EA1",  "#6C3302", 
             "#FDB515", "#00B0DA",  "#CFDD45")
colors <- set_names(c(palette[c(1:4,2,5)], "grey", "black"), 
                    c("TAC", "POMDP", "MSY", "CE", 
                      "POMDP: low prior",
                      "POMDP: high prior",
                      "biomass",
                      "catch"))
scale_colour_discrete <- function(...) scale_colour_manual(..., values=colors)
scale_fill_discrete <- function(...) scale_fill_manual(..., values=colors)
```


```{r load_data, message=FALSE, warning=FALSE}
log_dir <- "../data/observe_harvest_recruit" # solution files here

## Fig1, Fig2
sims <- read_csv(file.path(log_dir, "sims.csv"), col_types = "inicnnn")

## Fig 3
overest_sims <- read_csv(file.path(log_dir, "overest_sims.csv"))

## Fig 4
policies_w_priors <- read_csv(file.path(log_dir, "policies_w_priors.csv"))

## Fig 5
ram_ex <- read_csv(file.path(log_dir, "../ram_ex/ram_ex.csv"))

```


Imperfect information is ubiquitous in ecological management and conservation decision making. While the pressing concerns of global change have put the spotlight on forecasting, i.e. the uncertainty of the future [e.g. @Petchy2015], management decisions must also contend with uncertainty of the present: How many fish are in the sea today? What regions harbor the most fragile biodiversity? How do we make use of a rapidly expanding but opportunistically collected data, such as in citizen science efforts, which may involve strong sampling biases? Much of our focus in dealing with uncertainty has been through the lens of statistical approaches to model fitting.  The rise of approaches such as Hierarchical Bayesian Modeling have given us sophisticated tools to reflect uncertainty in our data and uncertainty in our knowledge of mechanisms and parameters in our models [@Ellison2004].  But estimating a model is not the same as making a decision, particularly when a model leaves us with considerable uncertainty about current and future states. A model can only provide the rules of the chess board.  It is the role of decision theory to provide us with a strategy.  

Decision theory has a long history in the ecological literature [e.g @Schaefer1954; @Walters1978; @Clark1990; @Shea1998; @Polasky2011] which has sometimes been overshadowed by recent emphasis on model fitting.  While in principle a model will be updated throughout the decision process (as we will discuss), it is convenient to think of the model as "given," estimated, with uncertainty, using the best available methods. The goal of a decision theory is not maximize some abstract notion of model fit (least squares, likelihood, etc), but a more practical notion of utility (happiness, economic value, or any combination of stakeholder objectives, see @Halpern2013).   Approaches for decision making under uncertainty in ecological systems can be divided into two camps: (1) those based upon "optimal control" solutions, and usually favored by natural resource economists, and (2) those based in heuristic methods such as scenario planning, resilience thinking, and precautionary rules of thumb, more commonly found in both ecological literature and actual practice [@Fischer2009; @Polasky2011]. While researchers have recognized the need to unify the transparent and quantitative algorithmic approach of optimal control with the greater complexity and uncertainty of real ecosystems that is acknowledged by heuristic methods, computational barriers to doing so have stymied this progress.  We illustrate how the limitations of these approaches have manifested in the example of fisheries management, and present a new approach that can combine the reality of measurement uncertainty and the rigor of optimization to resolve a long-standing paradox and suggest a more robust approach to management.  

The challenge of making decisions under uncertainty is obviously not unique to fisheries, and the existing methods we critique here can be found in a wide range of population and ecosystem management challenges, including fire ecology [@Richards1999], invasive species [@Blackwood2010; @Shea1998], disease outbreaks [@Shea2014; @Li2017], and protecting biodiversity [@Dee2017; @Iacona2017].  Yet fisheries conservation and management has long been both a crucible and proving ground for the theory of ecological management more generally, including topics such as adaptive management [@Walters1978], ecosystem-based management [@Levin2008] and resilience thinking [@Holling1973; @May1977], while also giving rise to the sub-discipline of resource economics [@Beverton1957; @Schaefer1954; @Gordon1954], thanks to its global relevance, long history, and readily available data.  Despite the generality of the models and issue of measurement uncertainty considered here, any application must be grounded in both the history and context of the particular decision problem. In light of this, we begin with a brief background on existing decision theory approaches common in fisheries management. 


In this paper, we examine three strategies to managing a natural population, such as a fishery, under such uncertainty.  This problem has a long history in both theory and practice, where seemingly innoccous simplifying assumptions have led to a deep paradox in how managers should respond to uncertainty.  The precautionary principle [@Kriebel2001] would seem to suggest that the greater the uncertainty in our models, the more cautious we should be in management policies.  Yet a well-known mathematical proof by @Reed1979 established that under quite general conditions, the optimal strategy under uncertainty is no different than under no uncertainty at all.  Attempts to resolve this have since only deepened this paradox, arguing that adding additional sources of uncertainty, such as imperfect measurements, should lead to optimal harvest that increases with greater uncertainty [e.g. @Clark1986; @Sethi2005].  Meanwhile, much of actual practice has (perhaps fortunately, as we shall see) ignored these results in favor of a more heuristic application of the precautionary principle.  Here, we show that this paradox can be resolved by uncovering previous shortcuts and tackling the optimal management problem head-on, which we can solve thanks to the computational efficiency of sophisticated algorithms developed more recently in the field of robotics.  This approach allows us to reject this paradox largely in favor of the precautionary principle. Further, our comparisons show that widely recognized existing approaches in both theory and practice are not by themselves sufficient to manage a population under substantial uncertainty over the long term, but our recently borrowed approach from robotics literature can under identical conditions sustain both higher biomass and higher economic yields than those approaches.  This conclusion has important implications not only for fisheries but eocsystem more broadly, underscoring the danger of not correctly accounting for measurement uncertainty when making decisions, and further to the significant opportunity to learn from fields such as robotics when faced with complex and uncertain decisions.  



# The Decision Problem

We consider the management problem of setting catch quotas for a marine fishery in the face of imperfect information about the current stock size and uncertainty about future recruitment.  We seek to determine the sequence of actions $h_t$ for $t \in [1, ... \infty]$ that maximize the net present value (discounted sum of all future profits) of the fishery.  We will denote the discount rate $\gamma$. For simplicity we will once again follow classic theory and assume a fixed price for fish, (equivalently, measuring our value in units of discounted fish rather than discounted dollars), though again this assumption is easy to relax. Each year, the manager also obtains an estimate $y_t$ of the true $x_t$ stock size subject to some measurement uncertainty $\xi_t$

\begin{equation}
y_t = \xi_t x_t 
\end{equation}

For simplicity we will assume measurement uncertainty is normally distributed with standard deviation $\sigma_m$,  $\xi \sim \mathcal{N}(1, \sigma_m)$.  Given an estimated population model along with this (uncertain) measurement of the stock size, the manager must choose the set of a harvest quotas $\lbrace h_t \rbrace$ for $t \in [0, 1, \infty]$ that maximizes expected long term utility of the stock:

\begin{equation}
\max_{ \lbrace h_t \rbrace } \mathbb{E} \left \{ \sum_{t=0}^{\infty} \gamma^t \cdot U(x_t, h_t) \right \}
\end{equation}

For convenience of presentation but without loss of generality, we will assume this utility is simply equal to the harvest itself; in economic terms, a fixed price for fish without cost on effort: 

\begin{equation}
 U(x_t, h_t) = \min(h_t, x_t)
\end{equation}

where the $\min$ function ensures no additional reward for attempting to harvest more than the entire stock.  Existing optimal control techniques (@Reed1979) prove these results are not dependent on the particular details of this utility.  Using this form allows a more direct comparison to approaches such as maximum sustainable yield (MSY), that do not include an economic model but merely maximize long-term catch. In principle, utility could also reflect ecosystem services or other intrinsic values for fish left in the sea and not merely the market for consumption [@Halpern2013]. 

The solution to this decision problem is conditional on a population model for the underlying ecological process, describing probability the system moves to state $x_{t+1}$ given that it was in state $x_t$ and the manager selected a harvest $h_t$, which we discuss below.  Such a model would typically be estimated and parameterized from available data, often (but not necessarily) using a hierarchical Bayesian approach that acknowledges the existence of uncertainty in both measurements and process [e.g. see @Dichmont2016 for a discussion of how uncertainties are frequently included in stock assessment models].  However, accounting for measurement uncertainty when going from data to model does not mean we have also accounted for this uncertainty when going from model to decision.  For example, a harvest decision policy based upon maximum sustainable yield simply depends on the stock size which maximizes the expected growth rate of the model.  Measurement uncertainty in model estimation can indeed influence the position of that maximum, but as we shall see, that strategy is only optimal in the absence of any uncertainty.

There is one further subtlety arising in this seemingly simple problem statement that we must address. Given our discrete-time formulation of the recruitment process, it is necessary to decide if the measurement $y_t$ happens before or after harvest $h_t$: that is do we: measure, recruit, harvest, or measure, harvest, recruit?  Following convention in the optimal control literature (e.g. [@Reed1979; @Clark1990; @Sethi2005]), we will assume the latter; measurement occurs immediately before harvest, followed by recruitment. This assumption has occasionally been reversed to introduce some additional uncertainty from stochastic recruitment immediately prior to setting the harvest quota [e.g. @Clark1986; @Weitzman2002], which appears to mimic uncertainty in measurements but does not allow uncertainty to accumulate since the measurement step still occurs without error.  

The optimal strategy must think not only about the next year, but rather considers the sequence of all future actions ${h_t}$, under all possible realizations of the underlying model.  This strategy must also acknowledge that the manager will receive new information each year, and may need to modify actions accordingly.  It is this ability of the decision problem to think ahead that allows it to tolerate short-term costs (e.g. reduced harvests in the current season) for larger future payoffs.  When Eq (1) is ignored, such optimal control problems are known as Markov Decision Processes or MDPs.  These are more commonly referred to in the ecological literature by their solution method of Stochastic Dynamic Programming [SDP; @Marescot2013], and widely used in both ecological management and animal behavior [@Mangel1985; @Mangel1988]. The addition of measurement uncertainty in Eq (1) turns this problem into a Partially Observed Markov Decision Process (POMDP), for which solution methods have not been widely available for large problems until more recently.  We discuss these decision methods in more detail below.


## Population model

To facilitate tractability and interpretation, we will focus on the well-studied Gordon-Schaefer model [@Schaefer1954; @Gordon1954] of logistic population growth (stock recruitment),  

\begin{equation}
x_{t+1} = \varepsilon_t (x_t-h_t) r  \left(1 - \frac{(x_t-h_t)}{K}\right) \label{Gordon-Schaefer}
\end{equation}

where $x_t$ is the current stock size, $h_t$ the harvest chosen that year, with parameters $r$ giving the individual growth rate, and $K$ the carrying capacity and $\varepsilon$ representing stochastic recruitment in a variable environment.  We have written this in terms of $x_t - h_t$ to underscore that we assume the convention of observe, harvest, recruit.  We will assume for simplicity $\varepsilon \sim \mathcal{N}(1, \sigma_g)$.  This and similar models are widely used in large scale analyses across diverse stocks (e.g. [@Costello2016; @Britten2017]), and form the basis for much of bioeconomic theory [@Clark1990]. As such, it will be easier to compare our results against intuition and classic theory, and avoid the possibility of differences arising only because of some particular subtle assumption hidden in a more complex model.

It is important to remember that all three decision methods we compare here will use this same model as given.  In the case of numerical simulations, we will simply pick reasonable fixed parameter values for the model above.  To illustrate the application to empirical data, we will first estimate these parameters using a hierarchical Markov Chain Monte Carlo (MCMC), and then use the resulting estimates to drive all three decision models.  As such, the details of how the model is estimated are immaterial to the differences in performance between these decision methods.  In all cases, the model is considered fixed.  Technically, it would be possible to re-estimate the model parameters given each new observation during the decision process.  Adaptations of the decision processes we consider here include this possibility for learning about the model during the decisions. Some include the possibility of taking knowingly bad actions, like suddenly increasing harvest rates, to improve learning over parameters.  We investigate these in subsequent work [@Memarzadeh2018].  For better comparison with established theory, here, the model is considered fixed. In the case of the simulations, the model is known without error (though still stochastic in nature), such that additional observations cannot improve the parameter estimates in any event.  Despite that obvious simplification, we shall illustrate how existing decision methods fail to account for measurement uncertainty appropriately.  Even with these simple models, decisions are complex, and knowing the rules of the game is not the same as knowing how to win.



<!-- MDP, POMDP -->

# Current Theory and Practice

@Gordon1954 and @Schaefer1954 independently showed in the same year that the maximum sustainable yield for the model bearing their names is achieved by reducing the stock to the  population to the size at which it obtains the maximum growth rate which is known as Biomass at Maximum Sustainable Yield, $B_{MSY}$. For the Gordon-Schaefer model (and many others), this is achieved at $B_{MSY} = K/2$.  They observed that fishing at a *constant yield* (that is, an individual fish mortality, $F$, such that harvest $H = F \cdot B$) of $F_{MSY} := \tfrac{H_{MSY}}{B_{MSY}}$)  will eventually lead to a population that converges to the biomass $B_{MSY}$ and produces the maximum sustainable harvest, $H_{MSY} = r K / 4$ in this model.  From here, theory and practice diverge.

This *constant yield* (constant mortality) solution thus corresponds to an equilibrium analysis which does not solve the time-dependent optimization problem above. In particular, this maximum sustainable yield (MSY) strategy will not be optimal whenever the stock is away from $B_{MSY}$.  @Clark1973 demonstrated (assuming no uncertainty in measurement or stochasticity in population dynamics) that the optimal time-dependent strategy is not one of constant yield, but rather of *constant escapement*. We will return to this approach in a moment.


## Uncertainty in Practice: MSY & TAC

Maximum Sustainable Yield (MSY) remains the basis of international law (including the UN,  IWC, IATTC, ICCAT, ICNAF; @Mace2001) and a familiar standard of management in terrestrial ecosystems as well as aquatic [@Clark1990].  Critics have for some time observed the limitations of harvesting at MSY in face of uncertainty in stock sizes and population dynamics [@Larkin1977; @Botsford1997].  Many US fisheries reflect this uncertainty through a series of adjustments that effectively reduce the target fishing mortality level to reflect this uncertainty.  Typically, a stock assessment model provides a best estimate of $B_{MSY}$ and corresponding mortality $F_{MSY}$ is used to define the stock Over-Fishing Limit, (OFL). Based on this, a somewhat lower level is set as the Allowable Biological Catch (ABC), reflecting uncertainty in the stock assessment. To reflect possible uncertainty between reported and actual catch, the ABC is reduced somewhat further to define the Total Allowable Catch, (TAC), which forms the basic unit of management for many such fisheries.  To reflect this process, our analysis will also consider policies in which the harvest quota is set at 80% of the level expected under the MSY policy: $H_{TAC}(t) = 0.8 \cdot F_{MSY} \cdot B_t$, for a biomass estimated at $B(t)$ in year $t$. To distinguish this approach from MSY, we will refer to this approach as a TAC policy.  This more closely represents a heuristic [e.g. @Hilborn2010] or resilience-based approach [sensu @Fischer2009] than an optimization-based policy.  Importantly, this approach shares the fundamentally stationary assumptions of an MSY policy by defining a constant mortality rather than a dynamic policy.  Thus, despite being more cautious overall and generating lower economic yield than a constant escapement policy, TAC policies continue to harvest at non-zero rates even if a stock falls below $B_{MSY}$, while the constant escapement policy does not.  

It is important to note that actual management strategies are quite diverse.  Our focus on comparisons TAC, MSY, and Constant Escapement (CE, also refereed to as MEY, see below) reflects only the subset of current practices.  Another increasingly common approach to address uncertainty in both process and models is known as Management Strategy Evaluation [MSE, @Smith1994;  @Dorner2009; @Bunnefeld2011; @Punt2016].  MSE performs forward simulations under a suite of pre-selected candidate strategies to determine which strategy achieves the best expected outcomes. Crucially, by limiting the analysis to a suite of candidate strategies over a finite number of replicate simulations, this approach is able to accommodate substantially greater complexity and uncertainty than has been possible with more formal optimal control approaches we discuss below.  Optimal control solutions rely on dynamic programming to consider all possible strategies (all possible sequences of harvest under all possible realizations of stock dynamics).  As such, MSE can be viewed as an approximation to the optimal control solutions considered below, a notion that has been formalized in the literature on approximate dynamic programming [@Nicol2011].  



## Optimal management

So far, attempts to provide a more formal basis for managing uncertainty than the heuristic adjustment of catch limits described above have largely foundered in a series of paradoxes.  Without uncertainty, the theoretical policies are quite intuitive: The result derived by @Clark1973 for an optimal dynamic strategy to replace the equilibrium solution of MSY can be summarized as: If the stock is most productive at $B_{MSY}$, then obtain $B_{MSY}$ as quickly as possible. Thus, at any level below $B_{MSY}$, the economically optimal thing to do is to completely shut down the fishery, while above this stock, harvests greater than $H_{MSY}$ will be needed to bring the stock back to $B_{MSY}$.  (This intuition must be adjusted slightly in the case of economic discounting of future profits, but is otherwise quite general, see @Clark1990).  This strategy is known as *constant escapement* (CE), since a constant sock size $B_{MSY}$ escapes harvest each year.  Because CE and MSY converge to the *same long-term biomass and same long-term average yield*, CE can appear to be merely a more formal justification for MSY.  However, in practice the two approaches are very different: because natural populations fluctuate year-to-year, under CE, a different harvest quota must be set each year to achieve the constant escapement.  Because CE is derived as the economic optimum (assuming perfect measurements), it is sometimes referred to as Maximum Economic Yield, [MEY; @Burgess2018], or as Rights Based Fisheries Management [RBFM, @Costello2016].


In the face of a naturally fluctuating population, previous arguments made by @Gordon1954; @Schaefer1954 or @Clark1973 no longer hold.  As noted above, the optimal harvest of a population under a model such as the stochastic Gordon Schaefer, Eq \eqref{Gordon-Schaefer}, is an example of a Markov Decision Problem (MDP) which must be solved with stochastic dynamic programming. Thanks to a mathematical proof provided by @Reed1979, fisheries managers have largely been able to bi-pass such computational effort.  However, this convenient result also opened the door to paradox of uncertainty that would haunt ecological management for at least the next four decades. 

## Reed's Paradox: $S = D$

 @Reed1979 proved that, under sufficiently general assumptions, the optimal escapement $S$ for a population under stochastic growth, is identical to @Clark1973's optimal escapement $D$ for a deterministic population, $S = D = B_{MSY}$.  This surprising result suggests that in going from a world where a manager has perfect knowledge of absolutely everything into a scenario where the manager faces considerable uncertainty about the future state of the world, no additional precaution is needed.  

## Clark's Paradox

@Clark1986 was among the first attempts to resolve Reed's Paradox. @Clark1986 (quite correctly, as we will see), identified the crux of Reed's Paradox as the absence of measurement uncertainty:

> An important tacit assumption in Reedâ€™s analysis, as in the other works referred
to above, is that the recruitment level X is known accurately prior to the harvest decision, [...] In the case of fishery resources, the stock level X is almost never known very accurately, owing to the difficulty of observing fish in their natural environment.

@Clark1986 were unable to solve the resulting problem exactly, but had to adopt an almost equally troublesome assumption:

> For reasons of tractability, we shall adopt the simplifying assumption that the escapement level S, is known exactly at the end of that period. (The mathematical difficulty of the problem increases markedly if this assumption is relaxed.) 

Unfortunately, this "simplifying assumption" serves to squash most of the measurement error, and their results instead only deepened the paradox, finding policies that become even *less* cautious as uncertainty increases:

> [Our] results appear to contradict the conventional wisdom of renewable resource management, under which high uncertainty would call for increased caution in the setting of quotas.

Relying on a quite different but still flawed assumption nearly two decades later, @Sethi2005 largely confirm Clark's Paradox, which they likewise observed with some concern:

> It may seem counter-intuitive that a measurement error causes lower expected escapements below the deterministic fishery closure threshold.

Despite these notes of caution, both @Clark1986 and @Sethi2005 ultimately attempt to rationalize this counter-intuitive conclusion rather than reject it.  Intuitively, uncertainty in the population growth model (stochasticity) or measurement error, would seem to justify harvesting fewer fish. Instead, existing optimal control theory has presented only the paradoxical results that uncertainty either should not matter at all, or that we should increase rather than decrease harvests in response to increased uncertainty. Numerous other attempts have been made to resolve this paradox through alternative assumptions, the most common being to assume from the outset to look only for 'constant-escapement' type policies [@Ludwig1981; @Roughgarden1996; @Engen1997;  @Moxnes2003]. Owing to the "mathematical difficulty" Clark first observed, none have attempted a direct solution which we will present here.  

In practice, TAC-managed fisheries are more common that CE-managed fisheries, at least in the United States. CE-based regulation is limited primarily to salmon, species for which population estimates may be more precise and thus closer to Reed's assumption.  We are not aware of any fishery that has put Clark's Paradox into practice, harvesting more in response to increased uncertainty.  As we shall illustrate, this is fortunate; though approaches that properly account for both forms of uncertainty can perform even better.


## POMDPs: An optimal treatment of measurement uncertainty

Why does the introduction of measurement uncertainty make the decision problem so much harder?  Consider the thought experiment of managing a fish stock where in each of the previous four years stock assessments have put the population size at, say, 51, 54, 49, 51, (say, measured in percent of carrying capacity, $K$). Under a constant escapement target of 50, the harvest quota would be 1, 4, 0, 1, respectively.  Note that this control rule depends only on the measurement for the year in question, which is assumed to be measured without error. If we then measure a stock size of 75, an assumption that this measurement is made without error would justify the sudden increase to a quota of 25. Yet if we admit the possibility of measurement error, this sudden bump starts to look very suspicious in light of all the previous observations.  Perfect measurements let us exploit the Markov property of the model -- the most recent measurement tells us all we need to know.  In contrast, the introduction of measurement uncertainty breaks this Markovian assumption: a rational decision maker would suspect this 75 to be an over-estimate based on prior observations. Under imperfect observations introduced by Eq (1), we no longer have a Markov Decision Process (MDP) over the observed state space.  Rather, we have a Partially Observed Markov Decision Process (POMDP). A POMDP policy cannot be expressed as a policy function at all (much less as policy function with a single constant-escapement target, as much previous work has assumed).  Instead, a POMDP policy can be thought of as depending not only on the most recent observation, but the recent observation combined with a *prior belief* about what state the system is in, which itself is determined by all past observations. In this manner, the POMDP can consider how much weight to give the most recent observation based on how it compares to prior beliefs.

Algorithmic innovations from the robotics community have now made it possible to numerically solve non-trivial POMDP problems. The need to consider all past observations becomes particularly demanding given the forward-looking nature of a decision problem.  Not only must we consider all possible sequences of future actions over all possible sequences of future states, but we must add to that all possible sequences of future measurements. The computational complexity involved has historically limited POMDP applications to contexts with only a handful of possible states and actions [e.g. @Chades2008; @Chades2011; @Fackler2014; @Fackler2014b], insufficient to capture fisheries models appropriately.  Meanwhile, methods to solve decision problems with imperfect information have advanced steadily in the field of robotics and artificial intelligence.  Almost contemporaneous with Reed's work,  papers by @Smallwood1973 and @Sondik1978 laid mathematical foundations for algorithms that could efficiently solve POMDP problems [e.g. @Kaelbling1998; @Pineau2003].  More recently, driven by demands in areas such as autonomous vehicle decision making, newer point-based approximation algorithms such as SARSOP [@Kurniawati2008] have made it possible to solve POMDPs with 100s of states and actions.  We have adapt this algorithm for application to the fisheries context, and provide an efficient implementation as a preliminary R package [@sarsop-pkg] which can be used to replicate and further explore results presented here. Details of the analysis presented here including annotated code to reproduce and further explore all of the following results is provided in the supplementary material.

Precise definitions of both the (fully observed) MDPs and POMDPs (not to be confused with Markov Process Models and Hidden Markov Process Models -- methods for which estimate the model but do not involve the feedback of any decision process) in an ecological context can be found in @Williams2011, or in classic work from the engineering and robotics community [e.g. @Smallwood1973 and @Sondik1978].  For convenience, we summarize the POMDP definition and common notation here.  The POMDP problem is posed identically to that of the MDP problem, with the addition of an observation process  The POMDP problem for fisheries question considered here can be summarized as follows:

- Transition function (state equation): $T(x_t, x_{t+1}, a_t)$: the probability that a system is in state $x_{t+1}$ at time $t+1$ given that it began in state $x_t$ at time $t$ and the manager took action $a_t$.  In our context, this relationship is given by the Gordon-Schaefer stock recruitment function $f$ with normally distributed growth uncertainty $x_{t+1} \sim \mathcal{N}(f(x_t,a_t), \sigma_g)$, truncated at zero to exclude negative population sizes. The action $a_t$ represents the harvest quota set for the fishery. Attempting to implement a quota the exceeds the true population size results in collapse of the fishery.  As @Clark1986 eloquently argues, assuming that extinction is impossible regardless of fishing intensity would unreasonably bias the decision problem. 

- Observation function: $O(x_t,y_t,a_{t-1})$ the probability of observing state $y_t$ given a system in state $x_t$.  In principle, the action chosen can influence the precision of the observation. In our case, we simply assume normally distributed errors around the true state, $y_t \sim \mathcal{N}(x_t, \sigma_m)$, truncated at zero to exclude negative population sizes.  

- Utility function: $U(x_t,a_t)$, the utility received at time $t$ for taking action $a_t$, given that the system is in state $x_t$.  For simplicity of analysis, we will simply set the utility to be equal to the harvested stock: $U(x_t, a_t) = \min(x_t, a_t)$, indicating that realized harvest cannot be negative.  This choice ensures that in the case of no uncertainty ($\sigma_g = \sigma_m = 0$), the optimal solution matches that expected under a simple MSY calculation. More realistic utility functions may include diminishing returns with increasing harvest (supply and demand effects), and the cost of fishing, both of which act to suppress large harvests. By focusing on a simple utility we can be sure that our comparison to MSY is driven by the treatment of uncertainty rather than merely differing economic assumptions.  

The optimization problem is to select the action $a_t$ that will maximize the net present utility over all time. Future utility may be discounted by a factor $\gamma$, so that a value  $V$ in $t$ year is valued at $\gamma^t V$ today.  Numerically, each of these functions are defined over a discrete set of possible states, observations, and actions, and can thus be represented as a collection of matrices or tensors.  


## Simulations

We consider the average fish biomass across 100 replicate simulations of the same stock dynamics (Eq 4) under three different management strategies: constant escapement (CE), total allowable catch (TAC; equal to 80% MSY), and partially observed Markov decision process (POMDP) management.  Each suite of simulations is considered under three sequentially higher measurement error regimes, from $\sigma_m = 0$ (no measurement errors), $\sigma_m = 0.1$ (low error), and $\sigma_m = 0.15$ (moderate error), as indicated, while stochastic recruitment (environmental noise) is set to a moderate $\sigma_g = 0.15$.  Empirical estimates of measurement error in stock sizes vary widely, with estimates often dependent upon methodological assumptions.  Early estimates have put possible error as high as 50% [@Clark1986] and more recent analyses have suggested an average of closer to 36%, though with cases that may be much higher [@Ralston2011].  Consequently, range between 0 to 15% provides a probably conservative estimate of typical unceratinty ranges, which we show is nevertheless large enough to drive substantially negative ecological and economic outcomes under management strategies that do not appropriately account for that error over the long run.  

# Results 


```{r sims, fig.width=7, fig.height=3.5, fig.cap="Average fish biomass under different management strategies under increasing levels of measurement uncertainty. Each plot the mean stock size over time across 100 replicate simulations under each policy: constant escapement (CE), Total allowable catch (TAC = 80% MSY), and the proposed partially observed Markov decision process (POMDP) method. Standard deviation from the mean across replicate simulations is shown as faint colored bands, indicating significant variation due to stochasticity between individual replicates.  Measurement error increases as a normal distribution with standard deviation 0, 0.1, or 0.15, as indicated at the top of the panel.  Environmental stochasticity is fixed a standard deviation of 0.15 in each panel.  Carrying capacity K normalized to 1, r = 0.75. Additional environmental noise levels and comparison to MSY rather than TAC can be found in the supplementary material. \\label{sims}"}
sims %>%
  select(-value) %>%
  filter(method != "MSY", sigma_g == "0.15") %>%
  group_by(time, method, sigma_m) %>%
  summarise(mean = mean(state), sd = sd(state)) %>% 
  mutate(sigma_m = as.character(sigma_m)) %>%
  ungroup() ->
fig1_df


fig1_df %>%
  ggplot(aes(time, mean, col=method, fill=method)) + 
  geom_line(lwd=1) + 
  geom_ribbon(aes(ymax = mean + sd, ymin = mean-sd), col = NA, alpha = 0.1) +
  facet_wrap(~ sigma_m, labeller = label_bquote(sigma[m] == .(sigma_m))) + 
  coord_cartesian(ylim = c(0, 1)) + 
  theme(legend.position = "bottom") + 
  ylab("Mean biomass")
```





In the absence of either environmental noise or measurement error POMDP, CE, and MSY would converge to stock at the $B_{MSY}$, while TAC would maintain the stock at a slightly higher level (see Supplemental material, Figure S1).  The introduction of stochastic growth has a significant negative impact on the TAC strategy, with a mean biomass significantly lower than $B_{MSY}$ (first panel, Figure \ref{sims}; this impact is even more severe for MSY, see Figure S2).  Without measurement error, the CE and POMDP strategies are nearly identical with both approximately maintaining the stock at $B_{MSY}$ despite the significant environmental stochasticity.  As measurement error increases in the subsequent panels, CE and TAC strategies perform increasingly poorly, while the POMDP continues to maintain the average stock close to $B_{MSY}$.  Notably, CE is significantly more impacted by measurement uncertainty than TAC, with CE averaging even lower biomass than TAC under moderate measurement uncertainty.  These results confirm that the precautionary approach represented by the TAC does indeed prove more robust to the problem of measurement error than the optimization solution represented by CE, but is less robust to environmental error. In contrast, the POMDP approach successfully handles both sources of uncertainty, maintaining higher stocks, near $B_{MSY}$ level, and producing the highest yield.  


```{r econ, fig.width=7, fig.height=3.5, fig.cap="Expected net present value of the fishery across strategies under increasing levels of measurement error $\\sigma_m$. Net present value is the sum of all future harvests discounted over time and averaged across 100 replicates simulations under each strategy, as shown in Figure \\ref{sims}. The value under constant escapement (CE) is optimal when measurements are perfect but decreases rapidly with increasing measurement error. The more cautious TAC is not economically optimal but largely unimpacted by increasing error, while POMDP attains consistently high economic yield despite the increasing uncertainty. \\label{econ}"}
sims %>%
  select(time, value, rep, method, sigma_m, sigma_g) %>%
  filter(sigma_g == "0.15", method != "MSY") %>%
  group_by(rep, method, sigma_m, sigma_g) %>%
  summarise(npv = sum(value)) %>%  
  group_by(method, sigma_m, sigma_g) %>%
  summarise(net_value = mean(npv), se = sd(npv) / mean(npv)) %>%
  ungroup() %>%
  
  ggplot(aes(method, net_value, ymin=net_value-se, ymax=net_value+se, fill=method)) + 
  geom_bar(position=position_dodge(), stat="identity") + 
  geom_errorbar(size=.3,width=.2,
                position=position_dodge(.9)) +
  facet_wrap(~sigma_m, 
             labeller = label_bquote(sigma[m] == .(sigma_m))) +
  theme(legend.position = "none") + 
  ylab("expected net present value")
```


This pattern in management success in ecological terms (the relatively recovery and maintenance of fish biomass) is also borne out in terms of economic performance. We find the mean net present value (averaging across replicates and discounting future profits by the discount factor $\gamma$) for these same simulations at increasing levels of measurement uncertainty (Figure \ref{econ} ).  As before, environmental stochasticity is set at $\sigma_g = 0.15$.  In the absence of measurement uncertainty, constant escapement (CE) is optimal (as per @Reed1979), while the heuristic caution built into the total allowable catch (TAC) strategy (at 80% MSY) results in a sub-optimal economic yield.  The presence of stochasticity in recruitment ($\sigma_g = 0.15$), also contributes to the reduction in yield under TAC.  Though CE is quite robust to the environmental stochasticity level, this strategy proves very sensitive to increasing measurement error, showing sharp declines in economic value, falling below the TAC economic value at $\sigma_m = 0.15$.    Though the risk of stock collapse does increase with increasing measurement error under TAC (as seen by the mean declines in Figure \ref{sims}), these have little impact on the economic value due to the discount rate.  A smaller discount rate would penalize unlikely but not improbable collapses more, since a significant amount of time is required to realize those rare events.  Supplemental Figure S3 summarizes these economic trends across different noise values $\sigma_g$ and includes comparison to a simple MSY policy.  In contrast to the declining economic performance of CE and the consistently sub-optimal economic yield for TAC, the POMDP strategy continues to generate economic yields at approximately the optimal level (as attained by CE in the absence of measurement error) despite the increasingly uncertain measurements.  This demonstrates that the reduced risk of stock collapse and higher average stock biomass attained by the POMDP strategy in the presence of high measurement error, Figure \ref{sims}) is not the result of a trivial reduction in harvesting under all circumstances, but rather, evidence of a more nuanced strategy that manages to account for the uncertainty in measurement while maintaining a reasonable harvest.  



<!-- Show results of POMDP when over-estimating! -->

```{r overest, fig.width=4, fig.height=3.5, fig.cap = "Average fish biomass when the POMDP strategy assumes a high level of measurement uncertainty, while simulations reflect perfect measurements.  Despite this overestimation, biomass under POMDP strategy closely tracks the optimal biomass under CE in the absence of measurement error.  \\label{overest}"}
overest_sims %>%
  filter(method != "MSY") %>%
  ggplot(aes(time, mean, col=method, fill=method)) + 
  geom_line(lwd = 1) + 
  geom_ribbon(aes(ymax = mean + sd, ymin = mean-sd), col = NA, alpha = 0.1) +
  coord_cartesian(ylim = c(0, 1))  + 
  theme(legend.position = "bottom") 
```

The POMDP strategy is also robust to overestimation of the level of measurement uncertainty.  In the simulation results shown in Figures \ref{sims} and \ref{econ}, we have assumed that the level of measurement uncertainty $\sigma_m$ was known, and saw that ignoring this uncertainty (as the CE policy does) has significant negative impact on ecological and economic outcomes.  If the level of measurement uncertainty is not known precisely, _overestimating_ the measurement error while using the POMDP strategy provides a precautionary approach that can nevertheless achieve nearly optimal ecological and economic outcomes.  Figure \ref{overest} summarizes the results of the same simulations as before, but under the scenario in which the POMDP approach assumes a measurement error of $\sigma_m = 0.15$, when in fact all simulated measurements are made without error ($\sigma_m = 0$).  This represents an extreme case of overestimating the measurement error. Stochastic growth remains the same as before, $\sigma_g = 0.15$, and simulations under TAC and CE policies are shown for comparison.  When measurement error is absent, Reed's proofs hold and the CE strategy is optimal. Figure \ref{overest} shows that the POMDP outcomes track almost exactly the CE outcomes despite the misplaced assumption that measurements are quite poor.  (As we have already seen, the TAC strategy is insufficiently cautious for this level of stochasticity in recruitment, resulting in over-exploitation and long-term decline). The ability of the POMDP solution to perform nearly optimally even when significantly overestimating the level of measurement uncertainty contrasts sharply to the significant declines from ignoring measurement uncertainty seen in the CE solutions in Figure \ref{sims}.  This demonstrates that while we may not know precisely the level of measurement error, we achieve far better outcomes overestimating measurement uncertainty than underestimating it.  This also underscores the observation that POMDP policy is quite robust to the details of the uncertainty.  We can get a better understanding for the performance of POMDP in these simulations by looking more closely at how any individual decision under a POMDP strategy compares to the action chosen by the current alternatives.  



```{r policy, fig.width=5, fig.height=6, fig.cap="Comparison of the harvest and escapement policies under each strategy as a function of the observed stock size.  Escapement refers to the expected fraction of fish left in the sea, $x-h$, while harvest refers to the target catch; two different conventions for plotting the same action. Uniquely, the POMDP policy plot will depend not only on the observed stock size, but also depends on prior information (bottom panel) as determined from any prior observations and actions.  Depending on this prior it may harvest less or more than the other policies given an identical observation.\\label{policy}", message=FALSE, warning=FALSE}
policies_w_priors %>% 
  gather(panel, value, -state, -policy) %>%
  rename(method = policy) %>%
  ggplot(aes(state, value, col=method)) + 
  geom_line(lwd=1)  +
  facet_wrap(~panel, ncol=1, scales = "free_y") +
  xlab("observed stock size") +
  ylab("policy") +
#  theme(legend.position = "bottom") +
  coord_cartesian(xlim = c(0,1), ylim = c(0,.8)) 
  
```


To better understand the differences in performance of these strategies and resolve the paradox of uncertainty, we must take a closer look at how the specific action recommended by each policy compares given the same observation.  Figure \ref{policy} shows the action taken by each strategy in response to a measurement of the stock size (biomass estimate).  These plots show, for any possible observations, which strategy will attempt to harvest most and which will attempt to harvest least. For comparison purposes, we plot policies both in terms of expected escapement, $S = Y - H$ as is typical in the optimal control literature, [e.g. @Reed1979; @Clark1986; @Sethi2005], and also directly in terms of the harvest quota $H$. These plots clearly illustrate the contrast between the constant escapement (CE) strategy and the precautionary Total Allowable Catch (TAC) strategy: CE sets harvest strictly to zero for stocks estimated at biomass below $B_{MSY}$, while TAC permits a modest harvest of even very small stocks. (Comparable plots with MSY can be found in the Supplemental Material).  In principle, the CE policy could depend on $\sigma_g$, but as @Reed1979 proved, the constant escapement level with stochasticity is the same as in the deterministic case, S = D, unless the noise level is quite high (comparison plots in Supplemental material.)  In contrast to this, our POMDP plots depend very much on both the choice of $\sigma_m$ and $\sigma_g$.  If $\sigma_m = 0$, they reduce exactly to the CE solution.  Here we show the corresponding policies for POMDP solutions focusing on $\sigma_g = 0.15$ as above, with a modest measurement uncertainty $\sigma_m = 0.1$.  Alternate combinations of measurement uncertainty can be found in the appendix but do not change the general pattern.  In addition to an explicit dependence on the measurement error, our POMDP solutions depend on another piece of information: any prior observations of the stock size. 

Differences in attention to prior beliefs, determined by prior observations, drive the differences between the POMDP strategy and the other strategies and can resolve the uncertainty paradox.  While the catch quota under both TAC and CE strategies can be completely determined given the most recent observation of the stock size by using the policy curves shown in Figure \ref{policy}, this is not the case for the POMDP approach. This fundamental difference is key to understanding the difference in performance and resolving the paradox of uncertainty.  The POMDP policy cannot be specified by the most recent observation alone. Instead, the POMDP policy depends on all prior observations, not just the most recent.  The reason for this complexity comes from the Markov property.  Observations of the state in the perfectly observed system satisfy the Markov property: once we have measured the current biomass exactly, we cannot get any better estimate of the current stock size by studying older measurements. When measurements are uncertain this is no longer the case: intuitively, by comparing the most recent measurement to previous observations we may be able to infer when any given measurement is unusually high or unusually low.  POMDP formalizes this intuition by capturing the information from all previous observations into a *prior belief*.  This prior belief is updated after every subsequent action and observation in accordance with Bayes Law.  The mechanics of this process are well documented in the extensive literature on POMDPs [e.g. @Smallwood1973; @Sondik1978; @Kurniawati2008; @Williams2011], but for our purposes it is sufficient to observe how this evolving prior belief serves to continually adjust the POMDP policy.  Supplemental Figure S9 (Appendix A) illustrates how the prior belief evolves in response to subsequent observations and actions over the course of an individual simulation. 

Figure \ref{policy} shows two separate policy curves (in terms of harvest and escapement) for the same POMDP solution given two different prior belief distributions (panel 3, priors). While both priors shown express considerable uncertainty about the precise stock size prior to the most recent observation, the lower prior is centered at a value $\tfrac{1}{4}K$ stock size, while the high prior is centered at a value of $\tfrac{3}{4}K$, relative to a (post-harvest, before observation) target size of $B_{MSY} = K/2$.  The POMDP policy is determined by the combination of this prior information and the most recent observation, as indicated by the two different POMDP curves for harvest/escapement shown corresponding to the different priors.  As with the other policies, the higher the most recent observation (x axis) the higher the POMDP recommended harvest.  Yet unlike the alternative strategies, the POMDP solution always reflects the prior information.  Consequently, relative to constant escapement (that is, no measurement error), the POMDP with low prior starts harvesting only at higher stock sizes and always harvests less.  In contrast under the high prior, the POMDP always harvests at the same or higher level than the constant escapement solution.  


**A resolution to the paradox.**

Herein lies our resolution to the paradox of uncertainty.  Previous work created this paradox by suggesting that increased harvest rates (decreased target escapement) would often be the rational response to increased uncertainty.  The exact solutions from the POMDP reveal that this is only an accident of the assumptions: it is indeed true that under certain circumstances, harvest levels should increase relative to the case of no uncertainty, but *only when prior knowledge suggests the stock size should be much higher than the most recent estimate would suggest*.  In the POMDP solution, all information must be put into its historical (and constantly updated) context.  When a measurement roughly matches the expectation of this prior context, Figure \ref{policy} shows that the optimal response from POMDP is roughly comparable or slightly more cautious to the harvest under no uncertainty, and not more aggressive as the paradox would suggest. Measurements that exceed expectations are tempered with some skepticism: while the CE solution is willing to meet a high stock measurement with a large harvest, the POMDP solutions increase harvest more cautiously.  

This difference between underestimating and overestimating accounts for the poor performance of the CE solution under large measurement uncertainty, where it over-harvests whenever measurements are too large.  Even though underestimating is equally likely under the measurement uncertainty model, sooner or later a run of "heads", a sequence of overestimations relative to the true stock, can drive stocks to very low levels where the chance of local extinction becomes possible.  It is precisely this asymmetry: that too much over-harvesting leads to an irreversible state of extinction, while too much under-harvesting is always reversible (modulo some lost revenue) that lay behind Clark's original intuition that there was something fishy about Reed's result that $S = D$: that uncertainty required no extra caution.  Constant escapement is particularly susceptible to over-harvesting starting from stock sizes much higher than $B_{MSY}$ since its bang-bang optimal solution attempts to bring stocks back to target level as fast as possible. CE is not so vulnerable to collapse from small stock sizes, since it shuts down all harvests once estimates fall below $B_{MSY}$. Stock collapse under TAC can also be driven by such a string of heads, but is unlikely at high stock sizes since harvest never exceeds $H_{MSY}$.  In both cases, some measurement uncertainty interacts with inherent stochasticity, which provides a continued source of variation to sizes above $B_{MSY}$, where CE strategy is most vulnerable, and below $B_{MSY}$, where TAC is most vulnerable.



```{r historical, message=FALSE, warning=FALSE, fig.width=7, fig.height = 5, fig.cap="Comparisons of harvest level that would be recommended by policies considered here relative to historical harvest levels in two commercial fish stocks.  POMDP solution assumes a measurement error of 10%. \\label{historical}"}
ram_ex %>%
  filter(model %in% c("biomass", "catch", "POMDP", "CE", "TAC")) %>%
  ggplot(aes(year, stock, col=model)) +
  geom_line(lwd=1) +
  facet_wrap(~commonname, scales = "free", ncol=1)  +
  ylab("stock biomass (metric tonnes)")
```


**Historical examples and implementation**.

So far we have focused on simulation and an examination of the relative policies under different prior information.  Figure \ref{historical} compares the harvest level that would have been recommended by each of the strategies we have considered here against the historically observed catch recorded for two commercially fished stocks: Argentine Hake and European Plaice.  Historical estimates of biomass and catch are taken from the R.A. Myers Legacy Stock Assessment database [@RAM]. Posterior distributions for parameters for the Gordon-Schaefer model are estimated with uncertainty through Markov Chain Monte Carlo using `nimble` [@nimble] on the historical data, illustrating how this process might be done in more complex models as well (details and code in Supplement, Appendix B).  $B_{MSY}$ and corresponding TAC and CE policies are calculated based on posterior mean estimates of the model parameters, along with POMDP solution assuming a 10% measurement error rate.  Though measurement error could be estimated directly from the raw data, this would not reflect the true measurement uncertainty arising from the stock assessment process.  Each strategy is then compared to historical observations to determine a recommended harvest.  As we have seen, the TAC and CE harvest policies are uniquely determined by the observed stock size relative to $B_{MSY}$, but the POMDP policy must be re-calculated each time step to reflect both the prior observation and prior action.

These historical examples provide another useful lens to compare how the different strategies respond in the face of fluctuations in real data, rather than model simulations.  In both stocks, historical catch almost always exceeds that recommended by any of our strategies, falling closer to the MSY value estimated (see Appendix B).   In Argentine Hake, the persistent declines result in both POMDP and CE strategies quickly closing down the fishery in an attempt to let the stock recover to a more productive target biomass, while TAC persists with merely a reduced harvest.  A small recovery of biomass in 1995 is met by an immediate uptick in harvest under CE, while the POMDP response is more conservative.  The example of European Plaice illustrates more volatility in the stock size, revealing further differences in the strategies.  Despite this volatility, the TAC level remains relatively level across all five decades, rising or dipping only slightly with changes in stock size.  In contrast, the CE harvest tracks this volatility almost exactly.  Here, the POMDP solution falls in between these extremes, almost mirroring which-ever of the two policies is more conservative: the POMDP solution matches the dips in harvest taken by CE to allow the stock to recover most quickly, but does not track the doubling of harvests recommended by CE in the mid 1980, increasingly only to the more modest harvest recommended by the TAC policy.   Once again, we see that POMDP solution provides a more consistently precautionary policy than either the over-simplified optimal control solution of CE or the more rule-of-thumb approach represented by TAC.  Though we have seen that the POMDP solution need not always be more conservative (lower harvest) than these strategies, it makes use of the all prior observations to tune the level of caution appropriately.  

# Discussion

Using modern algorithms we have been able to both crack the nut of measurement uncertainty in the optimal management of ecological populations such as marine fisheries, debunking a long-standing paradox created by previous literature which has argued that increased measurement uncertainty should be met with equal or larger harvests [e.g. @Reed1979; @Clark1986; @Sethi2005].  By using powerful algorithms developed first the robotics literature to solve POMDPs [@Kurniawati2008], we have been able to tackle this optimal control problem directly rather than resorting to the simplifying assumptions used in previous work.  Our solution confirms the intuition of the precautionary principle in a quantitatively precise form: under most (but not all) conditions, *greater uncertainty results in smaller optimal harvests*.  Despite frequently proposing smaller harvests than existing approaches, the POMDP solution achieves higher long-term economic value as well as higher average stock sizes over the long term.

This lesson has clear relevance in the context of fisheries management.  Here, practice is already wiser than theory, where the optimal control based on the CE results of @Clark1973 and @Reed1979 is limited to fisheries such as salmon where estimates in stock size may be less significant than in purely marine species. To our knowledge, no fishery has intentionally put the more aggressive harvest solutions of @Clark1986 and @Sethi2005 into practice.  Yet this does not lift the specter of these methods, where CE-based predictions feature prominently in global fisheries analyses as the economically optimal strategy and the fastest route to recovery [@Costello2016; @Burgess2018]. Our results raise serious questions about the optimistic forecasts predicted under these CE-based policies. Meanwhile, MSY remains the dominate standard international law [@Mace2001], and many well-managed US fisheries rely on a version of the TAC based precautionary adjustment to MSY to comply with catch limits under Magnuson-Stevens Act.  Our results show that these strategies are less sensitive to measurement error, but not immune.  Comparisons against more heuristic decision methods are more difficult: management strategy evaluation [MSE; @Smith1994; @Punt2016] will depend on precisely what management scenarios are considered.  Under sufficient uncertainty, both the existing optimal and precautionary approaches can lead to declines in biomass and economic returns which could be avoided by POMDP-based management.  

This conclusion has important broader implications for ecological management more generally.  Decision making under uncertainty is a central challenge for ecology and conservation biology, which frequently pits optimal control based approaches against more heuristic approaches such as resilience thinking, scenario planning, and the precautionary principle [@Polasky2011].  With economists frequently favoring the precise, stylized approach of optimal control and ecologists embracing the realities of greater complexity and uncertainty echoed in more heuristic approaches, this division can sometimes appear to pit economic outcomes against ecological objectives. That perspective is echoed in the paradox discussed here, in which economic optimization ignoring uncertainty has argued in cold mathematical logic for a rejection of the precautionary principle.  Our results demonstrate that this divide is artificial. With sufficiently powerful algorithms we can go some ways to realizing the call of @Fischer2009 to combine more ecologically realistic assumptions such as measurement error with optimal control approaches in ecological management.  Both sides are vindicated in our solution: economic optimization under POMDP does not contradict the precautionary principle, while under POMDP, optimal control can also achieve better ecological outcomes than blunt precautionary rule (i.e. TAC, which reduced all harvests by 20% below MSY target).  As @Fischer2009 predicted, unifying optimal control with more resilience-inspired approaches is win-win.  

If accounting for measurement uncertainty can resolve previous paradoxes and divides, it also raises additional challenges.  The approach discussed here is vulnerable both to the charge of being too simple to be realistic while also being too complicated to be feasible.  These issues are as easily recognized in other ecological management contexts, from harvests of wild game or forestry to pest outbreaks, [e.g. @Richards1999; @Blackwood2010; @Shea1998; @Shea2014; @Li2017; @Dee2017; @Iacona2017] as in fisheries, where ecological complexity is invariably high and management capacity invariably limited.  We address each of these in turn.  

Are the dynamics considered here too simple?  Our underlying model is undoubtedly much simpler than many of the age or stage structured models used in modern fisheries management -- aspects whose importance to ecological dynamics have been established well beyond fisheries as well.  Yet it is critical to bear in mind that this stylized one-dimensional model is used only to compare the relative performance of the different decision strategies considered here (TAC, CE, and POMDP) in order to illustrate the potential importance of uncertainty in measurement. There is little reason to believe CE or TAC would perform better under more complex cases such as age-structured models that only further deviate from the assumptions under which they were derived [e.g. @Holden2015]. POMDP approaches are in no way incompatible with more complex models, whether that be age structure or even more ambitious non-parametric representations defined directly from data using Gaussian Processes or other machine learning techniques [e.g. @Boettiger2015].  Simple models have always served as tools for comparison and intuition, and serve the same illustrative role here.  

Is this approach too complex to be feasible? The importance of simple and effective rules of thumb in conservation management has been well documented [e.g. @Chades2011]. Sophisticated and computationally intensive approaches such as POMDP may seem improbable at a time when many areas of natural resource management, even simple, rule-of-thumb based methods struggle to take root.  There is no doubt that the solution method needed here is computationally intensive even for the simple model considered here, and will only become more so under greater ecological complexity.  Indeed, it was precisely such computational limitations that led to the shortcuts in work such as @Clark1986, with the ensuing potentially misleading conclusions. While in the following decades ecologists largely turned away from computationally intensive optimization required for even simple models with stochastic dynamic programming, (while continuing to construct ever more complicated hierarchical models), engineers have chipped away at the decision problem to reveal algorithms such as SARSOP that make much larger dynamic programming problems tractable.  Yes, we may need even more sophisticated algorithms to accommodate greater ecological complexity, yet we believe such numerical obstacles are no excuse for management by half measures.  Rather, our example illustrates how ecologists and managers can learn from and leverage the tools developed in other disciplines to better face the challenges of management in a complex and changing world.  



## Future directions



Several limitations that have been studied in fully observed (MDP) optimal
decision problems, such as parameter uncertainty [e.g. @Ludwig1982], model 
uncertainty [@Williams2001; @Boettiger2015] and adaptive management [e.g. @Walters1976]
remain largely open challenges for partially observed systems. Future work 
could extend this analysis to more complex models, such as those with age structure,
as [@Holden2015] does for the fully observed case. Another limiting assumption 
common to MDPs and POMDPs is that of stationary dynamics: that the population 
dynamics equation itself is not changing over time. In reality, forces such as
climate change and other forms of environmental variations violate this
assumption  [@Britten2017]. Direct approaches such as @Fackler2014's
adaptation of Mixed Observability MDP [@Ong2010] do not scale to the number
of states and actions considered here. A value of information (VOI) analysis
for POMDP [e.g. @Johnson2015; @Memarzadeh2016b], could identify when it
is worthwhile to actively reduce measurement error.




<!--
Taken as a whole, most ocean fisheries yield a net negative economic return
[@FAO2009], with fishing persisting only with the support of government subsidies [@Arnason2012], 
meanwhile some 68% of global fisheries are not in good biological condition [@Costello2016].
While the causes for this are both complex and numerous, we have seen that both the economic
inefficiency and ecological health are hurt by current policies, including
both MSY and its more precautionary variants, as these all permit some level of harvest
below $B_{MSY}$.  Economists have for some time observed these inherent 
inefficiencies, and argued that the establishment of property rights in fisheries [@Arnason2012].
Approaches such as individual transferable quotas (ITQs) would incentivise
fisheries behavior to converge towards the more dynamic harvests of a constant
escapement policy, as doing so would increase the value of an individual's share.
@Arnason2012 argues that properly implemented, this would lead fisheries to desire
an even more dynamic adjustment of the TAC to maximize the value of their shares,
rather than to oppose the  @Costello2016 refers to this as Rights Based Fisheries 
Mangement, (RBFM), and it is precisely the willingness to shut down harvests for 
over-exploited fisheries that explains the faster recovery they predict under RBFM
relative to MSY. Though the @Costello2016 RBFM projections are based on a simple 
constant escapement policy which ignores uncertainty, the logic is quite general:
given property rights to establish an efficient market, it is not unrealistic to
expect fisheries adopting such dynamic polices. Indeed, the greater adoption of 
RBFM should spur the adoption of POMDP approaches as rights-holders seek strategies
that maximize the share values.  This is not to dismiss the immense practical
challenges in such an implementation, but to observe that such dynamic, better-performing
policies can be seen to embrace rather than ignore economic realities.  Notably,
the optimization approach assumed in POMDP can be easily adapted to reflect other
constraints such as the cost of idle fleets if a fishery is closed, or include
the value of ecosystem services from fish not harvested [@Halpern2013].  
-->



<!--Alternate utility functions do not increase
the complexity of the solution.  Note that fixed cost of a fleet doesn't alter the answer at all:
if you have the strategy that optimizes your profits when you have no expenses, you don't do a 
different strategy that gets less profit unless it will also lower costs.  So whether or not
you have to pay a fixed fee each year for boats, even if those boats are idle, is no reason
not to leave those boats idle.  only if leaving them idle is *more expensive* than operating them 
does this make sense, which seems unlikely.  -->

<!--
Moreover, regulating fishing effort rather than fishing catch, i.e. opening
a fishery for only certain days of the year rather than limiting dockside catch, is both
economically less efficient: for instance, it increasing costs due to the incentive to use more or larger fishing boats
to maximize catch in that time, and it decreases profits since much of the year's catch
is landed in a short window where it drives down prices, instead of being sold fresh throughout
the year. Because regulating effort is both less direct and more difficult to enforce, the uncertainty
in the expected harvest is also larger than in regulating catch.  
-->

# References 


